<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0">
    <title>Windows重装系统之Office</title>
    <link rel="stylesheet" href="../../style.css">
    <link rel="icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
    
    <style>
        /* 阅读进度条样式 */
        .reading-progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: #f0f0f0;
            z-index: 9999;
            transition: all 0.2s ease;
        }
        
        .reading-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007bff, #0056b3);
            width: 0%;
            transition: width 0.2s ease;
        }
        
        /* 图片放大模态框样式 - 类似微信公众号 */
        .image-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
        }
        
        .image-modal-content {
            display: block;
            margin: auto;
            max-width: 95vw;
            max-height: 95vh;
            min-width: 30vw;
            object-fit: contain;
            cursor: grab;
            transition: transform 0.2s ease;
        }
        
        .image-modal-content:active {
            cursor: grabbing;
        }
        
        .image-modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
            z-index: 10000;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .image-modal-close:hover,
        .image-modal-close:focus {
            color: #ddd;
            text-decoration: none;
        }
        
        /* 为文章中的图片添加光标样式 */
        .post-body img {
            cursor: pointer;
            transition: opacity 0.3s;
        }
        
        .post-body img:hover {
            opacity: 0.8;
        }
        
        /* 三端适配：图片放大模态框响应式设计 */
        @media (max-width: 639px) {
            .image-modal-content {
                max-width: 98vw;
                max-height: 90vh;
                min-width: 40vw;
            }
            
            .image-modal-close {
                top: 15px;
                right: 15px;
                font-size: 25px;
                width: 35px;
                height: 35px;
            }
        }
        
        @media (min-width: 640px) and (max-width: 1024px) {
            .image-modal-content {
                max-width: 95vw;
                max-height: 95vh;
                min-width: 60vw;
            }
            
            .image-modal-close {
                top: 18px;
                right: 18px;
                font-size: 28px;
                width: 38px;
                height: 38px;
            }
        }
            
            /* Markdown表格样式 - 适配三端，类似微信公众号效果 */
            .post-body table {
                border-collapse: collapse !important;
                margin: 20px auto !important;
                width: 100% !important; /* 与普通图片宽度一致 */
                max-width: 100% !important;
                overflow-x: auto !important;
                display: table !important; /* 使用table显示模式以确保居中 */
                font-size: 0.9em !important;
                box-sizing: border-box !important;
                border: 1px solid #e6e6e6 !important; /* 添加边框以更接近微信公众号效果 */
                border-radius: 4px !important; /* 轻微圆角 */
                background-color: #fff !important;
                table-layout: fixed !important; /* 固定表格布局，使列宽能更好地适应容器 */
            }
            
            /* 确保Pandoc生成的表格样式也正确应用 */
            .post-body table th,
            .post-body table td,
            .post-body table .header,
            .post-body table .odd,
            .post-body table .even {
                border: 1px solid #e6e6e6 !important; /* 边框颜色较浅 */
                padding: 10px 12px !important;
                text-align: left !important;
                word-break: break-word !important; /* 允许文字换行 */
                word-wrap: break-word !important; /* 确保长单词换行 */
                vertical-align: top !important; /* 顶部对齐，更符合微信公众号效果 */
                min-width: 70px !important;
                line-height: 1.5 !important; /* 添加行高，改善文字显示 */
                box-sizing: border-box !important; /* 确保padding不会增加元素宽度 */
            }
            
            .post-body table th,
            .post-body table .header {
                background-color: #f8f8f8 !important; /* 更浅的灰色背景 */
                font-weight: 500 !important; /* 减轻字体粗细 */
                color: #333 !important;
                text-align: left !important;
                padding: 10px 12px !important;
                line-height: 1.5 !important; /* 添加行高 */
            }
            
            .post-body table tr,
            .post-body table .odd,
            .post-body table .even {
                background-color: transparent !important; /* 微信公众号表格通常没有交替行颜色 */
            }
            
            .post-body table tr:nth-child(even),
            .post-body table .even {
                background-color: transparent !important; /* 微信公众号表格通常没有交替行颜色 */
            }
            
            .post-body table tr:hover {
                background-color: transparent !important; /* 移除悬停效果，更像微信公众号 */
            }
            

            
            /* 平板端适配 */
            @media (min-width: 769px) and (max-width: 1024px) {
                .post-body table {
                    font-size: 0.88em !important;
                    width: 100% !important; /* 平板端也保持100%宽度 */
                    display: table !important; /* 使用table显示模式以确保居中 */
                }
                
                .post-body table th,
                .post-body table td,
                .post-body table .header,
                .post-body table .odd,
                .post-body table .even {
                    padding: 10px 12px !important;
                    word-break: break-word !important;
                    box-sizing: border-box !important; /* 确保平板端单元格盒模型正确 */
                }
            }
            
            /* 防止内容溢出造成横向滚动 */
            .post-body {
                overflow-wrap: break-word;
                word-wrap: break-word;
                word-break: break-word;
            }
            
            .post-body pre {
                white-space: pre-wrap;
                word-wrap: break-word;
                overflow-x: auto;
            }
            
            .post-body code {
                white-space: pre-wrap;
                word-wrap: break-word;
                max-width: 100%;
                display: inline-block;
            }
            
            /* 长截图样式 - 限制宽度以防止影响布局 */
            .post-body img.long-image {
                max-width: 50% !important;
                width: 50%;
                height: auto;
                display: block;
                margin: 10px auto;
            }
            
            /* 微信公众号风格的普通截图样式 */
            .post-body img.normal-image {
                max-width: 100% !important;
                width: auto;
                height: auto;
                display: block;
                margin: 10px auto;
            }
            
            /* 图片基础样式 - 普通截图，类似微信公众号显示效果 */
            .post-body img:not(.long-image):not(.normal-image) {
                max-width: 100%;
                height: auto;
                display: block;
                margin: 10px auto;
                box-sizing: border-box;
            }
            
            /* 桌面端普通截图适配 - 适合直接阅读的大小 */
            @media (min-width: 1025px) {
                .post-body img:not(.long-image):not(.normal-image) {
                    width: auto;
                    max-width: 100%;
                    height: auto;
                    margin: 10px auto;
                }
            }
            
            /* 平板端普通截图适配 */
            @media (min-width: 769px) and (max-width: 1024px) {
                .post-body img:not(.long-image):not(.normal-image) {
                    width: auto;
                    max-width: 100%;
                    height: auto;
                    margin: 10px auto;
                }
            }
            
            /* 手机端普通截图适配 */
            @media (max-width: 768px) {
                .post-body img:not(.long-image):not(.normal-image) {
                    width: 100%;
                    max-width: 100%;
                    height: auto;
                    margin: 10px auto;
                }
                
                .post-body {
                    padding: 15px;
                }
                
                /* 手机端长截图样式 - 保持50%宽度 */
                .post-body img.long-image {
                    max-width: 50%;
                    width: 50%;
                }
                
                /* 手机端表格样式 - 保持与普通图片一致的宽度 */
                .post-body table {
                    font-size: 0.85em !important;
                    width: 100% !important; /* 重新设置宽度以确保与图片一致 */
                    display: table !important; /* 使用table显示模式以确保居中 */
                    overflow-x: auto !important;
                    white-space: normal !important; /* 允许内容换行 */
                }
                
                .post-body table th,
                .post-body table td,
                .post-body table .header,
                .post-body table .odd,
                .post-body table .even {
                    padding: 8px 10px !important;
                    min-width: 65px !important;
                    font-size: 0.95em !important; /* 手机端稍微大一点的字体 */
                    word-break: break-word !important; /* 确保手机端内容能正确换行 */
                    word-wrap: break-word !important;
                    box-sizing: border-box !important; /* 确保手机端单元格盒模型正确 */
                }
            }
            
            /* 为文章中的图片添加光标样式 */
            .post-body img {
                cursor: pointer;
                transition: opacity 0.3s;
            }
            
            .post-body img:hover {
                opacity: 0.8;
            }
            
            /* 平板端长截图样式 */
            @media (min-width: 769px) and (max-width: 1024px) {
                .post-body img.long-image {
                    max-width: 50%;
                    width: 50%;
                }
            }
            
            /* 桌面端长截图样式 */
            @media (min-width: 1025px) {
                .post-body img.long-image {
                    max-width: 50%;
                    width: 50%;
                }
            }
    </style>
</head>
<body>
    <div class="container">

        <article class="post-container">
            <header class="post-hero">
                            </header>

            <section class="post-content">
                <h1>Windows重装系统之Office</h1>
                <div class="post-meta">
                    <time datetime="2026-01-28 08:29:29">创建时间：2026-01-28 08:29:29</time>
                                        <span style="margin-left: 16px;">修改时间：<time datetime="2026-01-28 15:24">2026-01-28 15:24</time></span>
                                                            <span style="margin-left: 16px;">分类：<span class="category-tag">Windows</span></span>
                                        <span style="margin-left: 16px;">访问量：<span id="twikoo_visitors">0</span></span>
                </div>
                <div class="post-body">
                    <p>Office是许多Windows用户常用的软件之一。但是重装系统后该怎么重新下载安装，却使得有些人摸不着头脑。今天在这里推荐两款下载工具。</p>
                    <section id="office-tool-plus" class="level1">
                    <h1>1. Office Tool Plus</h1>
                    <p>Office Tool Plus是一款免费的简单小巧的 Office 工具，能帮助您部署并管理 Office。</p>
                    <p>官网地址：<a href="https://otp.landian.vip/zh-cn/">https://otp.landian.vip/zh-cn/</a></p>
                    <p><img src="https://img.114597.xyz/macOS/Office%20Tool%20Plus1.jpg" /></p>
                    <p>根据自己的系统下载对应的版本即可。下载后解压压缩包，双击<strong><em>Office Tool Plus.exe</em></strong>运行即可。</p>
                    <p><img src="https://img.114597.xyz/macOS/Office%20Tool%20Plus2.jpg" /></p>
                    <p><strong>部署过程</strong></p>
                    <ul>
                    <li><p>根据自己的系统选择对应的版本。
                    <img src="https://img.114597.xyz/macOS/Office%20Tool%20Plus3.jpg" /></p></li>
                    <li><p>选择需要安装的组件。
                    <img src="https://img.114597.xyz/macOS/Office%20Tool%20Plus4.jpg" /></p></li>
                    <li><p>点击“部署”按钮开始安装。
                    <img src="https://img.114597.xyz/macOS/Office%20Tool%20Plus5.jpg" /></p></li>
                    </ul>
                    </section>
                    <section id="mocreak" class="level1">
                    <h1>2. Mocreak</h1>
                    <p>Mocreak是一键自动化、无人值守下载、安装、部署 Office 的利器。</p>
                    <p>官网地址：<a href="https://mocreak.com/">https://mocreak.com/</a></p>
                    <p><img src="https://img.114597.xyz/macOS/Mocreak1.jpg" /></p>
                    <p>根据自己的需求下载即可，推荐安装版，双击<strong><em>Mocreak.exe</em></strong>运行即可。</p>
                    <p><img src="https://img.114597.xyz/macOS/Mocreak2.jpg" /></p>
                    <p><strong>部署过程</strong></p>
                    <ul>
                    <li><p>点击“下载/安装office组件”。
                    <img src="https://img.114597.xyz/macOS/Mocreak2.jpg" /></p></li>
                    <li><p>选择需要安装的组件，如果是安装版，可以选择勾选“开启Office自动更新服务”和“启动长效服务增强机制”这两个选项。
                    <img src="https://img.114597.xyz/macOS/Mocreak3.jpg" /></p></li>
                    <li><p>Mocreak会自动下载最新版本的Office安装文件，并进行安装，全过程都是自动进行的，无需人工干预。
                    <img src="https://img.114597.xyz/macOS/Mocreak4.jpg" /></p></li>
                    </ul>
                    <section id="三激活office" class="level2">
                    <h2>三、激活Office</h2>
                    <p><strong>1、命令激活</strong><br />
                    <strong><em>不用先去网上下载激活软件，只需一条命令即可自动完成，适用于Windows10以及Windows11系统。</em></strong></p>
                    <p><img src="https://img.114597.xyz/macOS/%E5%BE%AE%E8%BD%AF%E6%BF%80%E6%B4%BB%E8%84%9A%E6%9C%AC1.jpg" /></p>
                    <p>有以下3种方式打开命令窗口</p>
                    <ul>
                    <li>Windows10及以下系统，键盘按windows+R，输入cmd回车，打开cmd命令窗口<br />
                    </li>
                    <li>Windows11系统，右键Windows徽标选择终端（管理员），打开PowerShell命令窗口<br />
                    </li>
                    <li>Windows11系统，键盘按windows+R，输入powershell回车，打开PowerShell命令窗口<br />
                    <img src="https://img.114597.xyz/macOS/%E9%87%8D%E8%A3%85%E7%B3%BB%E7%BB%9F12.jpg" /></li>
                    </ul>
                    <p>在命令窗口，复制粘贴以下命令代码，回车。</p>
                    <p>通过此代码会自动下载激活脚本。</p>
                    <pre><code>irm https://get.activated.win | iex</code></pre>
                    <p><img src="https://img.114597.xyz/macOS/%E9%87%8D%E8%A3%85%E7%B3%BB%E7%BB%9F13.jpg" /></p>
                    <p>激活脚本下载成功后，会出现Microsoft 激活脚本窗口界面。</p>
                    <p>通过输入数字激活：</p>
                    <table>
                    <thead>
                    <tr class="header">
                    <th>数字</th>
                    <th>作用</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="odd">
                    <td>1</td>
                    <td>永久激活(数字权利激活)Windows</td>
                    </tr>
                    <tr class="even">
                    <td>2</td>
                    <td>Ohook方式激活Office</td>
                    </tr>
                    <tr class="odd">
                    <td>3</td>
                    <td>激活Windows到2038年</td>
                    </tr>
                    <tr class="even">
                    <td>4</td>
                    <td>KMS激活Windows/Office180天</td>
                    </tr>
                    </tbody>
                    </table>
                    <p><img src="https://img.114597.xyz/macOS/%E5%BE%AE%E8%BD%AF%E6%BF%80%E6%B4%BB%E8%84%9A%E6%9C%AC2.jpg" /></p>
                    <p>这里根据需要，键入2，接下来程序自动执行激活Office。</p>
                    <p>实际上这条命令相当于自动下载了一个激活用的批处理脚本，放到了%temp%目录下，执行完激活后自动删除，在系统中没有残留。这种方法好处是不需要经常去下载软件的最新版了，直接使用一条命令搞定，方便高效。如果还是希望去下载软件后使用，这个脚本是开源项目，可以去Github下载，安全可靠，非常好用: <a href="https://github.com/massgravel/Microsoft-Activation-Scripts">Microsoft-Activation-Scripts</a></p>
                    <p><strong>2、HEU_KMS_Activator</strong></p>
                    <blockquote>
                    <p>这款HEU_KMS_Activator由知己而知彼（活跃于微信公众号）开发，可以适用于所有Windows和Office版本，纯净无广告，非常好用。</p>
                    </blockquote>
                    <p>HEU KMS Activator下载：</p>
                    <p>地址1： <a href="https://wwi.lanzoup.com/b05gumbe">https://wwi.lanzoup.com/b05gumbe 密码:9xum</a></p>
                    <p>地址2： <a href="https://www.123pan.com/s/xY3DVv-375HA">https://www.123pan.com/s/xY3DVv-375HA</a></p>
                    <p>地址3： <a href="https://github.com/zbezj/HEU_KMS_Activator/releases">https://github.com/zbezj/HEU_KMS_Activator/releases</a></p>
                    <p>解压密码：<strong><span style="color:#ff5722;">HEU168</span></strong></p>
                    <p>蓝奏云链接经常会失效，把链接中的lanzoup修改为：lanzouh、lanzous、lanzousi、lanzoux、lanzouw、lanzouo、lanzouy，多尝试几个，就能打开了。</p>
                    <p><img src="https://img.114597.xyz/macOS/HEU1.jpg" /></p>
                    <p><strong><em>Windows10自带的杀毒软件Microsoft Defender会误报，使用前先把『实时保护』关闭，不需要其他设置，也不需要移除Microsoft Defender。待软件使用完毕后重新开启实时保护即可。</em></strong></p>
                    <ul>
                    <li>关闭『实时保护』：</li>
                    </ul>
                    <p><img src="https://img.114597.xyz/macOS/%E5%AE%89%E5%85%A8%E4%B8%AD%E5%BF%831.jpg" />
                    <img src="https://img.114597.xyz/macOS/%E5%AE%89%E5%85%A8%E4%B8%AD%E5%BF%832.jpg" />
                    <img src="https://img.114597.xyz/macOS/%E5%AE%89%E5%85%A8%E4%B8%AD%E5%BF%833.jpg" />
                    <img src="https://img.114597.xyz/macOS/%E5%AE%89%E5%85%A8%E4%B8%AD%E5%BF%834.jpg" /></p>
                    <ul>
                    <li>运行HEU_KMS_Activator.exe</li>
                    </ul>
                    <p><img src="https://img.114597.xyz/macOS/HEU2.jpg" /></p>
                    <ul>
                    <li>激活成功</li>
                    </ul>
                    <p><img src="https://img.114597.xyz/macOS/Office1.jpg" /></p>
                    </section>
                    </section>
                </div>
                
                <!-- 阅读进度条 -->
                <div id="reading-progress" class="reading-progress-bar">
                    <div id="reading-progress-fill" class="reading-progress-fill"></div>
                </div>
                
                <!-- 图片放大模态框 -->
                <div id="imageModal" class="image-modal">
                    <span class="image-modal-close" id="imageModalClose">&times;</span>
                    <div id="imageModalContent" style="display: flex; justify-content: center; align-items: center; height: 100%; width: 100%;">
                        <img class="image-modal-content" id="modalImage" style="max-width: 95vw; max-height: 95vh; object-fit: contain; cursor: grab;">
                    </div>
                </div>
            </section>

            <footer style="margin-top:28px;">
                <div class="article-navigation">
                    <div class="nav-prev">
                        <a href="#" id="prev-article" class="nav-link">
                            <span class="nav-arrow">←</span>
                            <span class="nav-title" id="prev-title">上一篇文章</span>
                        </a>
                    </div>
                    <div class="nav-home">
                        <a href="../index.html" class="nav-link">返回首页</a>
                    </div>
                    <div class="nav-next">
                        <a href="#" id="next-article" class="nav-link">
                            <span class="nav-title" id="next-title">下一篇文章</span>
                            <span class="nav-arrow">→</span>
                        </a>
                    </div>
                </div>
            <!-- 分割线：导航按钮与评论区之间 -->
            <hr style="margin: 28px 0; border: 0; border-top: 1px solid var(--border);">
            
            <!-- Twikoo 评论系统 -->
            <h2>评论</h2>
            <div id="tcomment"></div>
            
        </footer>
        

    </article>
</div>
    <script>
                
                // 获取当前文章的文件名（用于匹配articles.json中的url）
                function getCurrentArticleFileName() {
                    const currentUrl = window.location.pathname;
                    // 获取URL的最后一部分（文件名）
                    const fileName = currentUrl.split('/').pop();
                    // 解码URL编码的文件名
                    return decodeURIComponent(fileName);
                }
                
                // 获取当前文章的路径深度，用于计算正确的相对路径
                function getCurrentPathDepth() {
                    const currentUrl = window.location.pathname;
                    // 计算URL中'/'的数量，减去1得到深度
                    return currentUrl.split('/').filter(Boolean).length;
                }
                
                // 加载文章列表并执行回调函数
                function loadArticles(callback) {
                    // 尝试使用相对路径，处理不同深度的情况
                    let articlesPath;
                    const pathDepth = getCurrentPathDepth();
                    
                    // 修复路径处理逻辑
                    if (pathDepth === 3) {
                        // 路径为 /pages/posts/文章.html
                        articlesPath = '../../articles.json';
                    } else if (pathDepth === 2) {
                        // 路径为 /posts/文章.html
                        articlesPath = '../articles.json';
                    } else {
                        // 默认路径
                        articlesPath = '/articles.json';
                    }
                    
                    fetch(articlesPath)
                        .then(response => {
                            if (!response.ok) {
                                // 如果相对路径失败，尝试使用绝对路径
                                return fetch('/articles.json');
                            }
                            return response;
                        })
                        .then(response => response.json())
                        .then(articles => {
                            // 严格按发布日期从新到旧排序，与首页保持一致
                            const sortedArticles = articles.slice().sort((a, b) => {
                                // 严格按发布日期从新到旧排序
                                const dateA = a.date ? new Date(a.date) : 0;
                                const dateB = b.date ? new Date(b.date) : 0;
                                
                                // 按发布日期从新到旧排序
                                return dateB - dateA;
                            });
                            callback(sortedArticles);
                        })
                        .catch(error => {
                            console.error('获取文章列表失败:', error);
                            callback([]);
                        });
                }
                
                // 绑定上一篇文章按钮事件（跳转到更旧的文章）
                const prevArticleLink = document.getElementById('prev-article');
                const prevTitleSpan = document.getElementById('prev-title');
                if (prevArticleLink && prevTitleSpan) {
                    loadArticles(articles => {
                        const currentFileName = getCurrentArticleFileName();
                        const pathDepth = getCurrentPathDepth();
                        
                        const currentIndex = articles.findIndex(article => {
                            // 通过文件名匹配文章
                            return article.url.endsWith(currentFileName);
                        });
                        
                        // 如果找到并且不是最后一篇文章（最旧的文章），则更新上一篇文章按钮的标题
                        if (currentIndex >= 0 && currentIndex < articles.length - 1) {
                            const prevArticle = articles[currentIndex + 1];
                            prevTitleSpan.textContent = prevArticle.title;
                            // 设置跳转链接 - 根据当前路径深度调整
                            let articleUrl = prevArticle.url;
                            // 修复路径处理逻辑
                            // 修复路径处理逻辑
                            if (pathDepth === 3) {
                                // 当前在 /pages/posts/文章.html，需要调整路径
                                articleUrl = '../' + prevArticle.url;
                            } else if (pathDepth === 2) {
                                // 当前在 /posts/文章.html，需要调整路径
                                articleUrl = '../' + prevArticle.url;
                            } else {
                                // 其他情况，直接使用 url
                                articleUrl = '/' + prevArticle.url;
                            }
                            prevArticleLink.href = articleUrl;
                            prevArticleLink.style.cursor = 'pointer';
                            prevArticleLink.style.opacity = '1';
                        } else {
                            // 如果没有找到或者已是最旧的一篇，显示默认文本
                            prevTitleSpan.textContent = '已经是第一篇';
                            prevArticleLink.removeAttribute('href');
                            prevArticleLink.style.cursor = 'not-allowed';
                            prevArticleLink.style.opacity = '0.5';
                        }
                    });
                    
                    // 添加点击事件监听器
                    prevArticleLink.addEventListener('click', function(e) {
                        e.preventDefault();
                        // 如果有有效的链接，则跳转
                        if (this.href && this.href !== 'javascript:void(0);') {
                            window.location.href = this.href;
                        }
                    });
                }
                
                // 绑定下一篇文章按钮事件（跳转到更新的文章）
                const nextArticleLink = document.getElementById('next-article');
                const nextTitleSpan = document.getElementById('next-title');
                if (nextArticleLink && nextTitleSpan) {
                    loadArticles(articles => {
                        const currentFileName = getCurrentArticleFileName();
                        const pathDepth = getCurrentPathDepth();
                        
                        const currentIndex = articles.findIndex(article => {
                            // 通过文件名匹配文章
                            return article.url.endsWith(currentFileName);
                        });
                        
                        // 如果找到并且不是第一篇文章（最新的文章），则更新下一篇文章按钮的标题
                        if (currentIndex > 0) {
                            const nextArticle = articles[currentIndex - 1];
                            nextTitleSpan.textContent = nextArticle.title;
                            // 设置跳转链接 - 根据当前路径深度调整
                            let articleUrl = nextArticle.url;
                            // 修复路径处理逻辑
                            // 修复路径处理逻辑
                            if (pathDepth === 3) {
                                // 当前在 /pages/posts/文章.html，需要调整路径
                                articleUrl = '../' + nextArticle.url;
                            } else if (pathDepth === 2) {
                                // 当前在 /posts/文章.html，需要调整路径
                                articleUrl = '../' + nextArticle.url;
                            } else {
                                // 其他情况，直接使用 url
                                articleUrl = '/' + nextArticle.url;
                            }
                            nextArticleLink.href = articleUrl;
                            nextArticleLink.style.cursor = 'pointer';
                            nextArticleLink.style.opacity = '1';
                        } else {
                            // 如果没有找到或者已是最新一篇，显示默认文本
                            nextTitleSpan.textContent = '已经是最新篇';
                            nextArticleLink.removeAttribute('href');
                            nextArticleLink.style.cursor = 'not-allowed';
                            nextArticleLink.style.opacity = '0.5';
                        }
                    });
                    
                    // 添加点击事件监听器
                    nextArticleLink.addEventListener('click', function(e) {
                        e.preventDefault();
                        // 如果有有效的链接，则跳转
                        if (this.href && this.href !== 'javascript:void(0);') {
                            window.location.href = this.href;
                        }
                    });
                }
        </script>
        
        <!-- 悬浮按钮 -->
        <div class="floating-buttons">
          <button class="floating-btn" id="scroll-top" title="回到顶部">↑</button>
          <button class="floating-btn" id="scroll-bottom" title="前往底部">↓</button>
        </div>
        
        <script>
          // 悬浮按钮功能
          document.getElementById('scroll-top').addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
          });
          
          document.getElementById('scroll-bottom').addEventListener('click', () => {
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
          });
        </script>
        
        <script src="https://fastly.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.min.js"></script>
        
        <script>
          // 初始化Twikoo（默认配置）
          twikoo.init({
            el: '#tcomment',
            envId: 'https://www.twikoo.114597.xyz/'
          });

          // 如果需要访客数，延迟调用以避免 race condition
          setTimeout(() => {
            if (typeof twikoo !== 'undefined' && typeof twikoo.getVisitors === 'function') {
              twikoo.getVisitors([
                { url: window.location.pathname, title: document.title }
              ]).then(res => {
                const el = document.getElementById('twikoo_visitors');
                if (el && res && res[0]) el.innerText = res[0].visitors;
              }).catch(err => console.warn('twikoo.getVisitors error:', err));
            }
          }, 2000);
        </script>
        
        <script>
        // 图片放大功能 - 类似微信公众号效果
        document.addEventListener('DOMContentLoaded', function() {
            // 获取模态框元素
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const closeModal = document.getElementById('imageModalClose');
            
            // 移动端触摸事件变量
            let initialDistance = 0;
            let initialScale = 1;
            let currentScale = 1;
            let currentX = 0;
            let currentY = 0;
            let isDragging = false;
            let dragStartX = 0;
            let dragStartY = 0;
            
            // 为文章中的所有图片添加点击事件
            const images = document.querySelectorAll('.post-body img');
            
            images.forEach(function(img) {
                // 电脑端：单击放大
                img.addEventListener('click', function(e) {
                    // 检测设备类型，如果是移动设备则不执行单击放大
                    if (isMobileDevice()) {
                        return; // 移动设备上单击不放大
                    }
                    e.stopPropagation();
                    openModal(img);
                });
                
                // 移动端：双击放大
                let tapCount = 0;
                let timeoutRef = null;
                
                img.addEventListener('touchend', function(e) {
                    e.stopPropagation();
                    // 防止移动端双击缩放
                    e.preventDefault();
                    
                    if (isMobileDevice()) {
                        tapCount++;
                        if (tapCount === 1) {
                            // 第一次点击，设置定时器等待第二次点击
                            timeoutRef = setTimeout(function() {
                                tapCount = 0; // 重置计数器
                            }, 300); // 300ms内等待第二次点击
                        } else if (tapCount === 2) {
                            // 第二次点击，在这里打开模态框
                            clearTimeout(timeoutRef); // 清除定时器
                            tapCount = 0; // 重置计数器
                            openModal(img);
                        }
                    } else {
                        // 非移动设备，单击放大
                        openModal(img);
                    }
                });
            });
            
            // 检测是否为移动设备的函数（仅手机，不包括平板）
            function isMobileDevice() {
                // 使用更严格的移动设备检测，排除平板设备
                return window.innerWidth <= 768; // 只有手机端（屏幕宽度小于等于768px）才是移动设备
            }
            
            // 打开模态框的通用函数
            function openModal(img) {
                modal.style.display = 'block';
                
                // 优先使用data-original-url属性，如果不存在则使用src
                let originalSrc = img.getAttribute('data-original-url') || img.src;
                
                // 如果是常见的图床服务，尝试获取原始图片
                // 对于一些图床服务，可能需要移除缩放参数
                try {
                    const url = new URL(originalSrc);
                    
                    // 移除常见的缩放参数
                    url.searchParams.delete('w');
                    url.searchParams.delete('width');
                    url.searchParams.delete('h');
                    url.searchParams.delete('height');
                    url.searchParams.delete('imageMogr2');
                    url.searchParams.delete('imageView');
                    url.searchParams.delete('imageView2');
                    url.searchParams.delete('imageView2/1');
                    url.searchParams.delete('imageView2/2');
                    url.searchParams.delete('imageView2/3');
                    url.searchParams.delete('imageView2/4');
                    url.searchParams.delete('imageView2/5');
                    url.searchParams.delete('imageMogr');
                    url.searchParams.delete('imageResize');
                    url.searchParams.delete('imageQuality');
                    url.searchParams.delete('q');
                    url.searchParams.delete('quality');
                    url.searchParams.delete('format');
                    url.searchParams.delete('auto-orient');
                    url.searchParams.delete('ignore-error');
                    url.searchParams.delete('size');
                    url.searchParams.delete('s');
                    url.searchParams.delete('thumbnail');
                    url.searchParams.delete('thumb');
                    url.searchParams.delete('fit');
                    url.searchParams.delete('crop');
                    url.searchParams.delete('scale');
                    url.searchParams.delete('zoom');
                    url.searchParams.delete('max-age');
                    url.searchParams.delete('v');
                    url.searchParams.delete('t');
                    url.searchParams.delete('token');
                    url.searchParams.delete('sign');
                    url.searchParams.delete('timestamp');
                    url.searchParams.delete('signature');
                    url.searchParams.delete('auth_key');
                    
                    originalSrc = url.toString();
                } catch (e) {
                    // 如果URL解析失败，使用原始src
                    originalSrc = img.getAttribute('data-original-url') || img.src;
                }
                
                modalImg.src = originalSrc;
                
                // 设置alt属性（如果存在）
                if (img.alt) {
                    modalImg.alt = img.alt;
                } else {
                    modalImg.alt = '';
                }
                
                // 初始化状态
                currentScale = 1;
                currentX = 0;
                currentY = 0;
                modalImg.style.transform = 'scale(1) translate(0, 0)';
                modalImg.style.cursor = 'grab';
                
                // 确保图片加载后再设置初始状态
                modalImg.onload = function() {
                    // 重置缩放状态
                    currentScale = 1;
                    currentX = 0;
                    currentY = 0;
                    modalImg.style.transform = 'scale(1) translate(0, 0)';
                    modalImg.style.cursor = 'grab';
                    
                    // 确保移动端触摸事件可以立即使用
                    // 重新绑定触摸事件以确保在图片加载后有效
                    setupTouchEvents();
                };
                
                // 立即设置触摸事件，即使图片尚未加载完成
                setupTouchEvents();
                
                // 防止背景页面滚动
                document.body.style.overflow = 'hidden';
            }
            
            // 设置触摸事件的独立函数
            function setupTouchEvents() {
                // 移除可能存在的旧事件监听器
                modalImg.removeEventListener('touchstart', handleTouchStart);
                document.removeEventListener('touchmove', handleTouchMove);
                document.removeEventListener('touchend', handleTouchEnd);
                
                // 重新添加触摸事件监听器
                modalImg.addEventListener('touchstart', handleTouchStart, { passive: false });
                document.addEventListener('touchmove', handleTouchMove, { passive: false });
                document.addEventListener('touchend', handleTouchEnd);
            }
            
            // 触摸事件处理函数
            let touchVelocityX = 0, touchVelocityY = 0;
            let touchLastX = 0, touchLastY = 0;
            let touchLastTime = 0;
            let isPinching = false;
            
            function handleTouchStart(e) {
                if (e.touches.length === 2) {
                    // 双指缩放
                    e.preventDefault();
                    isPinching = true;
                    isDragging = false; // 停止拖拽
                    initialDistance = getDistance(e.touches[0], e.touches[1]);
                    initialScale = currentScale;
                } else if (e.touches.length === 1) {
                    // 单指拖拽
                    isDragging = true;
                    isPinching = false; // 停止缩放
                    dragStartX = e.touches[0].clientX - currentX;
                    dragStartY = e.touches[0].clientY - currentY;
                    
                    // 记录触摸开始位置和时间
                    touchLastX = e.touches[0].clientX;
                    touchLastY = e.touches[0].clientY;
                    touchLastTime = Date.now();
                    
                    modalImg.style.cursor = 'grabbing';
                    modalImg.style.transition = 'none'; // 拖拽时禁用过渡效果
                }
            }
            
            function handleTouchMove(e) {
                if (e.touches.length === 2 && isPinching) {
                    // 双指缩放
                    e.preventDefault();
                    const currentDistance = getDistance(e.touches[0], e.touches[1]);
                    const scale = (currentDistance / initialDistance) * initialScale;
                    
                    // 限制缩放范围
                    if (scale >= 0.5 && scale <= 10) {
                        currentScale = scale;
                        updateImageTransform();
                    }
                } else if (e.touches.length === 1 && isDragging) {
                    // 单指拖拽
                    e.preventDefault();
                    
                    const now = Date.now();
                    const timeDiff = now - touchLastTime;
                    
                    currentX = e.touches[0].clientX - dragStartX;
                    currentY = e.touches[0].clientY - dragStartY;
                    
                    // 计算速度
                    if (timeDiff > 0) {
                        touchVelocityX = (e.touches[0].clientX - touchLastX) / timeDiff;
                        touchVelocityY = (e.touches[0].clientY - touchLastY) / timeDiff;
                    }
                    
                    touchLastX = e.touches[0].clientX;
                    touchLastY = e.touches[0].clientY;
                    touchLastTime = now;
                    
                    updateImageTransform();
                }
            }
            
            function handleTouchEnd() {
                if (isDragging) {
                    isDragging = false;
                    modalImg.style.cursor = 'grab';
                    
                    // 触摸结束时的惯性滑动
                    if (Math.abs(touchVelocityX) > 0.1 || Math.abs(touchVelocityY) > 0.1) {
                        const inertiaDuration = 500; // 惯性持续时间
                        const startTime = Date.now();
                        
                        const inertiaMove = () => {
                            const elapsed = Date.now() - startTime;
                            const progress = Math.min(elapsed / inertiaDuration, 1);
                            
                            if (progress < 1) {
                                // 计算衰减系数
                                const decay = Math.pow(0.95, elapsed / 16); // 每16ms衰减
                                
                                currentX += touchVelocityX * 16 * decay;
                                currentY += touchVelocityY * 16 * decay;
                                
                                // 更新速度
                                touchVelocityX *= 0.95;
                                touchVelocityY *= 0.95;
                                
                                updateImageTransform();
                                requestAnimationFrame(inertiaMove);
                            }
                        };
                        
                        requestAnimationFrame(inertiaMove);
                    }
                }
                isPinching = false;
            }
            
            // 鼠标滚轮缩放 - 平滑缩放
            let wheelTimer;
            modalImg.addEventListener('wheel', function(e) {
                e.preventDefault();
                
                // 清除之前的定时器
                clearTimeout(wheelTimer);
                
                const wheelDelta = e.deltaY;
                const scaleFactor = wheelDelta > 0 ? 0.9 : 1.1;
                
                // 限制缩放范围
                const newScale = currentScale * scaleFactor;
                if (newScale >= 0.5 && newScale <= 10) {
                    currentScale = newScale;
                    updateImageTransform();
                }
                
                // 设置定时器，使缩放效果更平滑
                wheelTimer = setTimeout(() => {
                    updateImageTransform();
                }, 50);
            });
            
            // 鼠标拖拽事件
            let lastX = 0, lastY = 0;
            let velocityX = 0, velocityY = 0;
            let lastTime = 0;
            
            modalImg.addEventListener('mousedown', function(e) {
                isDragging = true;
                dragStartX = e.clientX - currentX;
                dragStartY = e.clientY - currentY;
                lastX = e.clientX;
                lastY = e.clientY;
                lastTime = Date.now();
                modalImg.style.cursor = 'grabbing';
                modalImg.style.transition = 'none'; // 拖拽时禁用过渡效果
            });
            
            document.addEventListener('mousemove', function(e) {
                if (isDragging) {
                    const now = Date.now();
                    const timeDiff = now - lastTime;
                    
                    currentX = e.clientX - dragStartX;
                    currentY = e.clientY - dragStartY;
                    
                    // 计算速度
                    if (timeDiff > 0) {
                        velocityX = (e.clientX - lastX) / timeDiff;
                        velocityY = (e.clientY - lastY) / timeDiff;
                    }
                    
                    lastX = e.clientX;
                    lastY = e.clientY;
                    lastTime = now;
                    
                    updateImageTransform();
                }
            });
            
            document.addEventListener('mouseup', function() {
                if (isDragging) {
                    isDragging = false;
                    modalImg.style.cursor = 'grab';
                    
                    // 惯性滑动效果
                    if (Math.abs(velocityX) > 0.1 || Math.abs(velocityY) > 0.1) {
                        const inertiaDuration = 500; // 惯性持续时间
                        const startTime = Date.now();
                        
                        const inertiaMove = () => {
                            const elapsed = Date.now() - startTime;
                            const progress = Math.min(elapsed / inertiaDuration, 1);
                            
                            if (progress < 1) {
                                // 计算衰减系数
                                const decay = Math.pow(0.95, elapsed / 16); // 每16ms衰减
                                
                                currentX += velocityX * 16 * decay;
                                currentY += velocityY * 16 * decay;
                                
                                // 更新速度
                                velocityX *= 0.95;
                                velocityY *= 0.95;
                                
                                updateImageTransform();
                                requestAnimationFrame(inertiaMove);
                            }
                        };
                        
                        requestAnimationFrame(inertiaMove);
                    }
                }
            });
            
            // 阻止模态框区域的默认触摸行为
            modal.addEventListener('touchstart', function(e) {
                if (e.touches.length === 1) {
                    e.preventDefault();
                }
            }, { passive: false });
            
            modal.addEventListener('touchmove', function(e) {
                e.preventDefault();
            }, { passive: false });
            
            // 计算两点间距离
            function getDistance(touch1, touch2) {
                const x = touch1.clientX - touch2.clientX;
                const y = touch1.clientY - touch2.clientY;
                return Math.sqrt(x * x + y * y);
            }
            
            // 更新图片变换
            function updateImageTransform() {
                modalImg.style.transform = 'scale(' + currentScale + ') translate(' + currentX + 'px, ' + currentY + 'px)';
            }
            
            // 点击关闭按钮关闭模态框
            closeModal.addEventListener('click', function(e) {
                e.stopPropagation();
                modal.style.display = 'none';
                // 恢复页面滚动
                document.body.style.overflow = 'auto';
            });
            
            // 为关闭按钮添加触摸事件以确保在移动设备上正常工作
            closeModal.addEventListener('touchend', function(e) {
                e.stopPropagation();
                e.preventDefault(); // 防止移动端的默认行为
                modal.style.display = 'none';
                // 恢复页面滚动
                document.body.style.overflow = 'auto';
            });
            
            // 点击模态框外部区域关闭模态框
            modal.addEventListener('click', function(e) {
                // 只有点击到背景区域（非图片本身）才关闭
                if (e.target === modal) {
                    modal.style.display = 'none';
                    // 恢复页面滚动
                    document.body.style.overflow = 'auto';
                }
            });
            
            // 防止图片点击关闭模态框
            modalImg.addEventListener('click', function(e) {
                e.stopPropagation();
            });
            
            // 按ESC键关闭模态框
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && modal.style.display === 'block') {
                    modal.style.display = 'none';
                    // 恢复页面滚动
                    document.body.style.overflow = 'auto';
                }
            });
            
            // 阅读进度条功能
            const progressBar = document.getElementById('reading-progress-fill');
            let scrollPercent = 0;
            let currentPercent = 0;
            let animationFrame;
            
            function updateScrollPercent() {
                // 获取页面滚动信息
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                
                // 计算滚动百分比
                scrollPercent = scrollHeight > 0 ? (scrollTop / scrollHeight) * 100 : 0;
            }
            
            function smoothAnimation() {
                // 使用缓动函数使动画更平滑
                currentPercent += (scrollPercent - currentPercent) * 0.1;
                
                // 更新进度条宽度
                progressBar.style.width = currentPercent + '%';
                
                // 继续动画循环
                animationFrame = requestAnimationFrame(smoothAnimation);
            }
            
            // 监听滚动事件，但只更新百分比值
            window.addEventListener('scroll', function() {
                updateScrollPercent();
            });
            
            // 页面加载完成后初始化
            updateScrollPercent();
            smoothAnimation();
        });
        
        // 自动检测长截图并应用相应样式
        document.addEventListener('DOMContentLoaded', function() {
            // 获取所有文章中的图片
            const images = document.querySelectorAll('.post-body img, .post-content img');
            
            images.forEach(function(img) {
                // 创建一个新的Image对象来获取原始尺寸
                const tempImg = new Image();
                tempImg.onload = function() {
                    // 计算宽高比，专门检测垂直方向很长的截图（如手机长截图）
                    const aspectRatio = tempImg.naturalWidth / tempImg.naturalHeight;
                    const heightWidthRatio = tempImg.naturalHeight / tempImg.naturalWidth; // 高度/宽度
                    
                    // 检测长截图的条件：
                    // 1. 高度远大于宽度（高宽比 > 2.0），表示这是一个纵向很长的图片（如手机长截图）
                    // 2. 同时宽度在合理范围内（300-1200像素，符合常见屏幕截图尺寸）
                    // 3. 或者原始高度特别大（超过3000像素）
                    // 4. 或者高宽比在2.0-5.0之间的典型手机截图比例
                    if ((heightWidthRatio > 2.0 && tempImg.naturalWidth > 300 && tempImg.naturalWidth < 1200) || 
                        tempImg.naturalHeight > 3000 ||
                        (heightWidthRatio >= 2.0 && heightWidthRatio <= 5.0 && tempImg.naturalWidth > 300)) {
                        img.classList.add('long-image');
                    } else {
                        // 普通图片添加normal-image类（虽然默认样式相同，但为了语义化）
                        img.classList.add('normal-image');
                    }
                };
                
                // 处理图片加载错误的情况
                tempImg.onerror = function() {
                    // 如果无法获取原始尺寸，默认当作普通图片处理
                    img.classList.add('normal-image');
                };
                
                // 设置临时图片的src以触发加载
                tempImg.src = img.src;
            });
        });
        </script>
</body>
</html>
